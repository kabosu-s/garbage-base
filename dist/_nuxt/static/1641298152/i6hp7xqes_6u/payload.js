__NUXT_JSONP__("/i6hp7xqes_6u", (function(a,b){return {data:[{id:"i6hp7xqes_6u",createdAt:a,updatedAt:b,publishedAt:a,revisedAt:b,title:"制作時メモ【前後の記事を取得してみる】",mainimage:{url:"https:\u002F\u002Fimages.microcms-assets.io\u002Fassets\u002F30dedbc29bbf472a8bd932f7df5e77d6\u002Feeac577d4a4541458a68d4fa8714c847\u002Fvue_back.jpg",height:600,width:1200},body:"\u003Chtml\u003E\u003Chead\u003E\u003C\u002Fhead\u003E\u003Cbody\u003E\u003Cp\u003E前後の記事のリンクを記事の下に貼りたいですよね。\u003Cbr\u003E貼りたいです。\u003Cbr\u003E\u003Cbr\u003E調べたら公式で解説されてました。\u003Cbr\u003E\u003Cbr\u003E\u003Ca href=\"https:\u002F\u002Fdocument.microcms.io\u002Ffaq\u002Fget-previous-or-next\" target=\"_blank\" rel=\"noopener noreferrer\"\u003E一つ前 \u002F 一つ後ろのコンテンツはどのように取得すれば良いですか？\u003C\u002Fa\u003E\u003Cbr\u003E\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"hljs\"\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002Fコンテンツ情報を取得しているところ\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E { contents } = \u003Cspan class=\"hljs-keyword\"\u003Eawait\u003C\u002Fspan\u003E client\n  .get({\n    \u003Cspan class=\"hljs-attr\"\u003Eendpoint\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E'blog'\u003C\u002Fspan\u003E,\n    \u003Cspan class=\"hljs-attr\"\u003Equeries\u003C\u002Fspan\u003E: {\u003Cspan class=\"hljs-attr\"\u003Elimit\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-number\"\u003E1000\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-attr\"\u003Efields\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E'id,title'\u003C\u002Fspan\u003E} \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F1000件、タイトルとIDだけを取得する\u003C\u002Fspan\u003E\n  })\n\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E index = contents.findIndex(\u003Cspan class=\"hljs-function\"\u003E(\u003Cspan class=\"hljs-params\"\u003Econtent\u003C\u002Fspan\u003E) =&gt;\u003C\u002Fspan\u003E content.id === slug); \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F取得情報から自分のIDを満たす最初の要素の位置をかえす\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E prev = contents[index - \u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E]; \n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E next = contents[index + \u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E];\n\u003Cspan class=\"hljs-built_in\"\u003Econsole\u003C\u002Fspan\u003E.log([prev, next]);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cbr\u003Ejs弱者なので…だいぶ悩みましたが…、頑張って、解読して…\u003Cbr\u003E\u003Cbr\u003E\u003Ccode\u003EfindIndex()\u003C\u002Fcode\u003E\u003Cbr\u003E\u003Cbr\u003Eこのメソッドでつまずいたので調べます。\u003Cbr\u003E調べると…\u003Cbr\u003E\u003C\u002Fp\u003E\u003Cblockquote\u003EfindIndex() メソッドは、配列内の指定されたテスト関数を満たす最初の要素の位置を返します。テスト関数を満たす要素がない場合を含め、それ以外の場合は -1 を返します。\u003Cbr\u003E\u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fja\u002Fdocs\u002FWeb\u002FJavaScript\u002FReference\u002FGlobal_Objects\u002FArray\u002FfindIndex\" target=\"_blank\" rel=\"noopener noreferrer\"\u003EArray.prototype.findIndex()\u003C\u002Fa\u003E\u003C\u002Fblockquote\u003E\u003Cp\u003E\u003Cbr\u003E\u003Cstrong\u003E取得情報から自分のIDを満たす位置をかえす\u003C\u002Fstrong\u003E\u003Cbr\u003Eということかな。\u003Cbr\u003E\u003Cbr\u003E一定の記事を取得→今の記事IDの位置を探す→+-1して前後の記事を代入\u003Cbr\u003Eという流れのようでした。\u003Cbr\u003E\u003Cbr\u003Eというわけで、こんな感じのメソッドで作ってみます。\u003Cbr\u003E\u003Cbr\u003E\u002Fsrc\u002Fview\u002FArticleDetail.vue\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"hljs\"\u003Eexport \u003Cspan class=\"hljs-keyword\"\u003Edefault\u003C\u002Fspan\u003E {\n    \u003Cspan class=\"hljs-keyword\"\u003Edata\u003C\u002Fspan\u003E() {\n        \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E {\n            prev: {},\n            next: {},\n        };\n    },\n    methods: {\n        async getPrevNext() {\n            \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E response = await axios.\u003Cspan class=\"hljs-keyword\"\u003Eget\u003C\u002Fspan\u003E( \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002Fデータを取得\u003C\u002Fspan\u003E\n                process.env.VUE_APP_X_API_URL_BLOG +\n                    \u003Cspan class=\"hljs-string\"\u003E\"?limit=100\"\u003C\u002Fspan\u003E + \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002Fとりあえず100件\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"hljs-string\"\u003E\"&amp;fields=id,title,mainimage\"\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F画像も出したいのでimgも\u003C\u002Fspan\u003E\n                {\n                    headers: {\n                        \u003Cspan class=\"hljs-string\"\u003E\"X-API-KEY\"\u003C\u002Fspan\u003E: process.env.VUE_APP_X_API_KEY,\n                    },\n                }\n            );\n            \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E contents = response.\u003Cspan class=\"hljs-keyword\"\u003Edata\u003C\u002Fspan\u003E.contents;\n            \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E index = contents.findIndex(\n                (content) =&gt; content.id === \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.$route.params.id \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F取得したデータから自分のIDの位置を探す\u003C\u002Fspan\u003E\n            );\n            \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.prev = contents[index + \u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E]; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F前の記事\u003C\u002Fspan\u003E\n            \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.next = contents[index - \u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E]; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F後の記事\u003C\u002Fspan\u003E\n        },\n    },\n};\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cbr\u003Eなんかprevとnextが公式と+-が逆でした。\u003Cbr\u003E…あれ？ prevが前で、nextが次…よね？\u003Cbr\u003E\u003Cbr\u003Eとはいえ、うまく行った？ぽい！\u003Cbr\u003Eつづきます\u003C\u002Fp\u003E\u003C\u002Fbody\u003E\u003C\u002Fhtml\u003E",tag:[]}],fetch:{},mutations:void 0}}("2021-08-18T13:02:04.579Z","2021-08-18T13:34:20.166Z")));